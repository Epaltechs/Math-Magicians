{"version":3,"names":["isNumber","item","match","calculate","obj","buttonName","total","next","operation","includes","operate","parseFloat","toString"],"sources":["calculate.js"],"sourcesContent":["import operate from './operate';\n\nfunction isNumber(item) {\n  return !!item.match(/[0-9]+/);\n}\n\n/**\n * Given a button name and a calculator data object, return an updated\n * calculator data object.\n *\n * Calculator data object contains:\n *   total:s      the running total\n *   next:String       the next number to be operated on with the total\n *   operation:String  +, -, etc.\n */\nexport default function calculate(obj, buttonName) {\n  if (buttonName === 'AC') {\n    return {\n      total: null,\n      next: '0',\n      operation: null,\n    };\n  }\n\n  if (isNumber(buttonName)) {\n    if (buttonName === '0' && obj.next === '0') {\n      return {};\n    }\n    // If there is an operation, update next\n    if (obj.operation) {\n      if (obj.next && obj.next !== '0') {\n        return { ...obj, next: obj.next + buttonName };\n      }\n      return { ...obj, next: buttonName };\n    }\n    // If there is no operation, update next and clear the value\n    if (obj.next && obj.next !== '0') {\n      return {\n        next: obj.next + buttonName,\n        total: null,\n      };\n    }\n    return {\n      next: buttonName,\n      total: null,\n    };\n  }\n\n  if (buttonName === '.') {\n    if (obj.next) {\n      if (obj.next.includes('.')) {\n        return { ...obj };\n      }\n      return { ...obj, next: `${obj.next}.` };\n    }\n    if (obj.operation) {\n      return { ...obj, next: '0.' };\n    }\n    if (obj.total) {\n      if (obj.total.includes('.')) {\n        return {};\n      }\n      return { ...obj, next: `${obj.total}.` };\n    }\n    return { ...obj, next: '0.' };\n  }\n\n  if (buttonName === '=') {\n    if (obj.next && obj.operation) {\n      return {\n        total: operate(obj.total, obj.next, obj.operation),\n        next: null,\n        operation: null,\n      };\n    }\n    // '=' with no operation, nothing to do\n    return {};\n  }\n\n  if (buttonName === '+/-') {\n    if (obj.next) {\n      return { ...obj, next: (-1 * parseFloat(obj.next)).toString() };\n    }\n    if (obj.total) {\n      return { ...obj, total: (-1 * parseFloat(obj.total)).toString() };\n    }\n    return {};\n  }\n\n  // Button must be an operation\n\n  // When the user presses an operation button without having entered\n  // a number first, do nothing.\n  // if (!obj.next && !obj.total) {\n  //   return {};\n  // }\n\n  // User pressed an operation after pressing '='\n  if (!obj.next && obj.total && !obj.operation) {\n    return { ...obj, operation: buttonName };\n  }\n\n  // User pressed an operation button and there is an existing operation\n  if (obj.operation) {\n    if (obj.total && !obj.next) {\n      return { ...obj, operation: buttonName };\n    }\n\n    if (!obj.total) {\n      return { total: 0, operation: buttonName };\n    }\n\n    return {\n      total: operate(obj.total, obj.next, obj.operation),\n      next: null,\n      operation: buttonName,\n    };\n  }\n\n  // no operation yet, but the user typed one\n\n  // The user hasn't typed a number yet, just save the operation\n  if (!obj.next) {\n    return { operation: buttonName };\n  }\n\n  // save the operation and shift 'next' into 'total'\n  return {\n    total: obj.next,\n    next: null,\n    operation: buttonName,\n  };\n}\n"],"mappings":"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"}